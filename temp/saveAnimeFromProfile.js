import { MongoClient } from 'mongodb'
import fs from 'fs/promises'

const mongoDBUrl = 'mongodb://localhost:27017';
const client = new MongoClient(mongoDBUrl)



// Database Name
const dbName = 'mal';

async function main() {
	// Use connect method to connect to the server
	await client.connect();
	console.log('Connected successfully to server');
	const db = client.db(dbName);
	const collection = db.collection('anime');

	let foo = await fs.readFile('./nugen_exe_trun.json')
	let animeList = JSON.parse(foo)

	let anime = animeList.map(e => e.node)
	// console.log(anime)
	
	const insertResult = await collection.insertMany(anime);
	console.log('Inserted documents =>', insertResult);

	// the following code examples can be pasted here...

	return 'done.';
}

main()
	.then(console.log)
	.catch(console.error)
	.finally(() => client.close());
